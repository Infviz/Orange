var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(o,a,s,l){return new(s||(s=Promise))(function(e,t){function n(e){try{i(l.next(e))}catch(e){t(e)}}function r(e){try{i(l.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((l=l.apply(o,a||[])).next())})},__generator=this&&this.__generator||function(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},Orange,Orange,Orange;void 0===window.WeakMap&&function(){var r=Object.defineProperty,e=Date.now()%1e9,t=function(){this.name="__st"+(1e9*Math.random()>>>0)+e+++"__"};t.prototype={set:function(e,t){var n=e[this.name];n&&n[0]===e?n[1]=t:r(e,this.name,{value:[e,t],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},delete:function(e){var t=e[this.name];if(!t)return!1;var n=t[0]===e;return t[0]=t[1]=void 0,n},has:function(e){var t=e[this.name];return!!t&&t[0]===e}},window.WeakMap=t}(),function(e){var l=new window.WeakMap,o=window.msSetImmediate;if(!o){var n=[],r=String(Math.random());window.addEventListener("message",function(e){if(e.data===r){var t=n;n=[],t.forEach(function(e){e()})}}),o=function(e){n.push(e),window.postMessage(r,"*")}}var a=!1,s=[];function u(){a=!1;var e=s;s=[],e.sort(function(e,t){return e.uid_-t.uid_});var r=!1;e.forEach(function(e){var n,t=e.takeRecords();(n=e).nodes_.forEach(function(e){var t=l.get(e);t&&t.forEach(function(e){e.observer===n&&e.removeTransientObservers()})}),t.length&&(e.callback_(t,e),r=!0)}),r&&u()}function d(e,t){for(var n=e;n;n=n.parentNode){var r=l.get(n);if(r)for(var i=0;i<r.length;i++){var o=r[i],a=o.options;if(n===e||a.subtree){var s=t(a);s&&o.enqueue(s)}}}}var p,h,t=0;function i(e){this.callback_=e,this.nodes_=[],this.records_=[],this.uid_=++t}function c(e,t){this.type=e,this.target=t,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function f(e,t){return p=new c(e,t)}function g(e){return h||((n=new c((t=p).type,t.target)).addedNodes=t.addedNodes.slice(),n.removedNodes=t.removedNodes.slice(),n.previousSibling=t.previousSibling,n.nextSibling=t.nextSibling,n.attributeName=t.attributeName,n.attributeNamespace=t.attributeNamespace,n.oldValue=t.oldValue,(h=n).oldValue=e,h);var t,n}function v(e,t){return e===t?e:h&&((n=e)===h||n===p)?h:null;var n}function y(e,t,n){this.observer=e,this.target=t,this.options=n,this.transientObservedNodes=[]}i.prototype={observe:function(e,t){var n;if(n=e,e=window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(n)||n,!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var r,i=l.get(e);i||l.set(e,i=[]);for(var o=0;o<i.length;o++)if(i[o].observer===this){(r=i[o]).removeListeners(),r.options=t;break}r||(r=new y(this,e,t),i.push(r),this.nodes_.push(e)),r.addListeners()},disconnect:function(){this.nodes_.forEach(function(e){for(var t=l.get(e),n=0;n<t.length;n++){var r=t[n];if(r.observer===this){r.removeListeners(),t.splice(n,1);break}}},this),this.records_=[]},takeRecords:function(){var e=this.records_;return this.records_=[],e}},y.prototype={enqueue:function(e){var t,n=this.observer.records_,r=n.length;if(0<n.length){var i=v(n[r-1],e);if(i)return void(n[r-1]=i)}else t=this.observer,s.push(t),a||(a=!0,o(u));n[r]=e},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(e){var t=this.options;t.attributes&&e.addEventListener("DOMAttrModified",this,!0),t.characterData&&e.addEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.addEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(e){var t=this.options;t.attributes&&e.removeEventListener("DOMAttrModified",this,!0),t.characterData&&e.removeEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.removeEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(e){if(e!==this.target){this.addListeners_(e),this.transientObservedNodes.push(e);var t=l.get(e);t||l.set(e,t=[]),t.push(this)}},removeTransientObservers:function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(e){this.removeListeners_(e);for(var t=l.get(e),n=0;n<t.length;n++)if(t[n]===this){t.splice(n,1);break}},this)},handleEvent:function(e){switch(e.stopImmediatePropagation(),e.type){case"DOMAttrModified":var t=e.attrName,n=e.relatedNode.namespaceURI,r=e.target;(o=new f("attributes",r)).attributeName=t,o.attributeNamespace=n;var i=e.attrChange===MutationEvent.ADDITION?null:e.prevValue;d(r,function(e){if(e.attributes&&(!e.attributeFilter||!e.attributeFilter.length||-1!==e.attributeFilter.indexOf(t)||-1!==e.attributeFilter.indexOf(n)))return e.attributeOldValue?g(i):o});break;case"DOMCharacterDataModified":var o=f("characterData",r=e.target);i=e.prevValue;d(r,function(e){if(e.characterData)return e.characterDataOldValue?g(i):o});break;case"DOMNodeRemoved":this.addTransientObserver(e.target);case"DOMNodeInserted":r=e.relatedNode;var a,s,l=e.target;s="DOMNodeInserted"===e.type?(a=[l],[]):(a=[],[l]);var u=l.previousSibling,c=l.nextSibling;(o=f("childList",r)).addedNodes=a,o.removedNodes=s,o.previousSibling=u,o.nextSibling=c,d(r,function(e){if(e.childList)return o})}p=h=void 0}},e.JsMutationObserver=i,e.MutationObserver||(e.MutationObserver=i)}(this),function(e){var t=function(){function t(e){if(null==e)this._value=t.generateV4Uuid();else{if(!t.isUuid(e))throw"The argument passed to Orange.Uuid() is not a valid Uuid.";this._value=e}}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),t.generateV4Uuid=function(){var n=t.getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)})},t.generate=function(){return new t},t.isUuid=function(e){return new RegExp("[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89ab][0-9a-fA-F]{3}-[0-9a-fA-F]{12}").test(e)},t.prototype.sameValueAs=function(e){return this._value.toLowerCase()===e._value.toLowerCase()},t.prototype.toString=function(){return this._value},t._counter=0,t._tStart=null==Date.now?Date.now():(new Date).getTime(),t.getTime=null==window.performance&&null==window.performance.now?function(){return Math.round(performance.now()+t._tStart)}:null==Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},t}();e.Uuid=t}(Orange||(Orange={})),function(e){!function(e){e.inject=function(e){if(null==window.Reflect)throw new Error("An attempt to use Orange.Modularity.inject decorator was made without an available Reflect implementation.");e.dependencies=function(){return window.Reflect.getMetadata("design:paramtypes",e)||[]}},e.dependency=function(e,t){var n;if(null==window.Reflect)throw new Error("An attempt to use Orange.Modularity.dependency decorator was made without an available Reflect implementation.");e.constructor.propertyDependencies=__assign({},e.constructor.propertyDependencies,((n={})[t]=window.Reflect.getMetadata("design:type",e,t),n))};var l=function(r){function e(e,t){var n=r.call(this)||this;return n.innerError=t,n.message=e,n.name="ResolveError",n}return __extends(e,r),e}(Error);e.ResolveError=l;var t=function(){function c(){this.typeMap=[],this.instances=[],this.registerInstance(c,this)}return Object.defineProperty(c,"defaultContainer",{get:function(){return c._defaultContainer},enumerable:!0,configurable:!0}),c.prototype.registerInstance=function(e,t){this.instances.push({key:e,value:t})},c.prototype.registerType=function(e,t){this.typeMap.push({key:e,value:t})},c.prototype.tryResolve=function(i,o){return void 0===o&&(o=!1),__awaiter(this,void 0,void 0,function(){var t,n,r;return __generator(this,function(e){switch(e.label){case 0:if("string"!=typeof i)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,c.getConstructorFromString(i)];case 2:return null==(t=e.sent())?[2,{instance:null,success:!1}]:(i=t,[3,4]);case 3:return e.sent(),[2,{instance:null,success:!1}];case 4:return null!=(n=this.lookup(this.instances,i))?[2,{instance:n,success:!0}]:(r=this.lookup(this.typeMap,i)||i,0==c.isValidConstructor(r)?[2,{instance:null,success:!1}]:0==this.checkArity(r)?[2,{instance:null,success:!1}]:[4,this.buildObject(r)]);case 5:return n=e.sent(),!0===o&&this.registerInstance(i,n),[2,{instance:n,success:!0}]}})})},c.prototype.resolve=function(a,s){return void 0===s&&(s=!1),__awaiter(this,void 0,void 0,function(){var t,n,r,i,o;return __generator(this,function(e){switch(e.label){case 0:if("string"!=typeof(t=a))return[3,5];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,c.getConstructorFromString(a)];case 2:return n=e.sent(),t=n,[3,4];case 3:throw r=e.sent(),new l("Failed to resolve type '"+a+"', see innerError for details",r);case 4:if(null==t)throw new l('No constructor identified by "'+a+'" could be found');e.label=5;case 5:if(null!=(i=this.lookup(this.instances,t)))return[2,i];if(o=this.lookup(this.typeMap,t)||t,0==c.isValidConstructor(o))throw new l('Orange.Modularity.Container failed to resolve type "'+a+'"');if(0==this.checkArity(o))throw new l('Orange.Modularity.Container failed to resolve type "'+a+'"');return[4,this.buildObject(o)];case 6:return i=e.sent(),!0===s&&this.registerInstance(t,i),[2,i]}})})},c.prototype.resolveWithOverride=function(e,t){var n=new c;return n.typeMap=this.typeMap,n.instances=t.concat(this.instances),n.resolve(e,!1)},c.getConstructorFromString=function(u){return __awaiter(this,void 0,void 0,function(){var t,n,r,i,o,a,s,l;return __generator(this,function(e){switch(e.label){case 0:for(t=u.split("."),n=window,r=0,i=t;r<i.length&&(o=i[r],null!=n[o]);r++)n=n[o];if(c.isValidConstructor(n))return[2,n];if((n=null)!=window.require&&(n=window.require(u)),null!=n)return[3,4];if(null==window.SystemJS)return[3,4];a=window.SystemJS,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,a.import(u)];case 2:return s=e.sent(),n=s,[3,4];case 3:return l=e.sent(),console.error("Container.getConstructorFromString",l),[2,null];case 4:return null==n?[2,null]:c.isValidConstructor(n)?[2,n]:null!=n.default&&c.isValidConstructor(n.default)?[2,n.default]:[2,null]}})})},c.prototype.lookup=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i.key===t)return i.value}},c.prototype.buildObject=function(n){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.createInstance(n)];case 1:return t=e.sent(),[4,this.setProperties(n,t)];case 2:return e.sent(),[2,t]}})})},c.prototype.createInstance=function(u){return __awaiter(this,void 0,void 0,function(){var t,n,r,i,o,a,s,l;return __generator(this,function(e){switch(e.label){case 0:return 0!=(u.dependencies?u.dependencies().length:0)?[3,1]:(t=new u,[3,6]);case 1:n=[],r=u.dependencies(),i=0,o=r,e.label=2;case 2:return i<o.length?(a=o[i],l=(s=n).push,[4,this.resolve(a)]):[3,5];case 3:l.apply(s,[e.sent()]),e.label=4;case 4:return i++,[3,2];case 5:t=this.applyConstructor(u,n),e.label=6;case 6:return[2,t]}})})},c.prototype.setProperties=function(u,c){return __awaiter(this,void 0,void 0,function(){var t,n,r,i,o,a,s,l;return __generator(this,function(e){switch(e.label){case 0:for(r in t=u.propertyDependencies,n=[],t)n.push(r);i=0,e.label=1;case 1:return i<n.length?(o=n[i],a=t[o],s=c,l=o,[4,this.resolve(a)]):[3,4];case 2:s[l]=e.sent(),e.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},c.prototype.checkArity=function(e){return(e.dependencies?e.dependencies().length:0)===(e.length||e.arity||0)},c.isValidConstructor=function(e){return null!=e&&"function"==typeof e},c.prototype.applyConstructor=function(e,t){return new(Function.bind.apply(e,[null].concat(t)))},c._defaultContainer=new c,c}();e.Container=t}(e.Modularity||(e.Modularity={}))}(Orange||(Orange={})),function(Orange){var Modularity;!function(Modularity){var RegionManager=function(){function RegionManager(e){this.container=e}return RegionManager.prototype.disposeRegions=function(e){var t=e.getAttribute("data-view");if(null==t||""==t){if(void 0!==e.children)for(var n=0;n<e.children.length;n++)this.disposeRegions(e.children[n])}else{var r=e.instance;"function"==typeof r.dispose&&r.dispose()}},RegionManager.prototype.initializeRegions=function(root){return __awaiter(this,void 0,void 0,function(){var attr,i,viewType,view,idAttr;return __generator(this,function(_a){switch(_a.label){case 0:if(attr=root.getAttribute("data-view"),null!=attr&&""!=attr)return[3,1];if(void 0!==root.children)for(i=0;i<root.children.length;i++)this.initializeRegions(root.children[i]);return[3,3];case 1:return viewType=eval(attr),[4,this.container.resolve(viewType)];case 2:view=_a.sent(),void 0!==view.element&&(view.element=root),idAttr=root.getAttribute("data-view-id"),null!=idAttr&&""!=attr&&"undefined"!==view.setViewId&&view.setViewId(idAttr),root.instance=view,_a.label=3;case 3:return[2]}})})},RegionManager}();Modularity.RegionManager=RegionManager}(Modularity=Orange.Modularity||(Orange.Modularity={}))}(Orange||(Orange={}));var TemplateLoader=function(){function s(){}return s.staticlyLoaded=function(){s.onload&&s.onload()},s.load=function(o){for(var a=0,t=0;t<o.length;t++)!function(){var e=o[t],r=e.id,i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState){if(200!==i.status&&0!==i.status)throw"Failed to load template.";var e=document.createElement("script"),t=document.createAttribute("type");t.value="text/html";var n=document.createAttribute("id");n.value=r,e.setAttributeNode(t),e.setAttributeNode(n),e.innerHTML=i.responseText,document.body.appendChild(e),++a==o.length&&s.onload&&s.onload()}},i.open("GET",e.path,!0),i.send()}()},s}(),Orange,Orange,Orange,Orange,Orange,Orange,Orange;!function(e){var t,n;t=e.Controls||(e.Controls={}),n=function(){function i(){this._element=null,this._id=null,this.disposables=new Array,this._propertyChangedListeners=new Array}return Object.defineProperty(i.prototype,"element",{get:function(){return this._element},set:function(e){if(null!=this._element)throw"The 'element' property can only ever be set once.";this._element=e,this.onElementSet()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"id",{get:function(){return this._id},set:function(e){if(null!=this._id)throw"The 'id' property can only ever be set once.";this._id=e},enumerable:!0,configurable:!0}),i.prototype.addDisposable=function(e){this.disposables.push(e)},i.prototype.dispose=function(){t.ControlManager.disposeControl(this)},i.prototype.addPropertyChangedListener=function(e){this._propertyChangedListeners.push(e)},i.prototype.removePropertyChangedListener=function(e){var t=this._propertyChangedListeners.indexOf(e);-1<t&&this._propertyChangedListeners.splice(t,1)},i.getPropertyName=function(e){var t=i.propertyRegex.exec(String(e));return t[t.length-1]},i.prototype.raisePropertyChanged=function(e){var t=null;if("string"==typeof e)t=e;else{if("function"!=typeof e)throw"Invalid argument passed to raisePropertyChanged";t=i.getPropertyName(e)}if(void 0===this[t])throw"Attempt to access undefined property '"+t+"' was made.";var n=this[t];this.onPropertyChanged(t,n);for(var r=this._propertyChangedListeners.length-1;0<=r;r--)this._propertyChangedListeners[r](t,n)},i.prototype.onElementSet=function(){},i.prototype.onPropertyChanged=function(e,t){},i.prototype.onControlCreated=function(){},i.propertyRegex=/return ([_a-zA-Z0-9]+)(\.([_a-zA-Z0-9]+))*;?/,i}(),t.Control=n}(Orange||(Orange={})),function(e){!function(e){var t=function(){function e(e){this._template=e}return e.prototype.applyTemplate=function(e,t){e.innerHTML=this._template,t(!0)},e}();e.StringTemplateProvider=t;var n=function(){function e(e){this._templateName=e}return e.prototype.applyTemplate=function(e,t){var n=document.body.querySelector("#"+this._templateName);null!=n?(e.innerHTML=n.innerHTML,t(!0)):t(!1,"No script tag with id='"+this._templateName+"' found")},e}();e.ScriptTemplateProvider=n;var r=function(n){function e(e){var t=n.call(this)||this;return t._templateProvider=null,t._isTemplateApplied=!1,t._templateProvider=e,t}return __extends(e,n),Object.defineProperty(e.prototype,"isTemplateApplied",{get:function(){return this._isTemplateApplied},enumerable:!0,configurable:!0}),e.prototype.onApplyTemplate=function(){},e.prototype.applyTemplate=function(n){var r=this;this._templateProvider.applyTemplate(this.element,function(e,t){if(!e)throw{message:"TemplatedControl.applyTemplate: A template provider failed to apply its template: "+(t||"").toString(),templateProvider:r._templateProvider,element:r.element};r._isTemplateApplied=!0,r.onApplyTemplate(),n()})},e}(e.Control);e.TemplatedControl=r}(e.Controls||(e.Controls={}))}(Orange||(Orange={})),function(e){var i,t;i=e.Controls||(e.Controls={}),t=function(r){function e(e,t){var n=r.call(this,new i.ScriptTemplateProvider(e))||this;return n.templateName=e,n._dataContext=null,n._dataContext=null==t?null:t,n}return __extends(e,r),Object.defineProperty(e.prototype,"dataContext",{get:function(){return this._dataContext},set:function(e){this._dataContext=e,this.applyTemplate(function(){})},enumerable:!0,configurable:!0}),e.prototype.getControl=function(e){var t=this.element.querySelector(e);return null==t||null==t.orange||null==t.orange.control?null:t.orange.control},e.prototype.applyTemplate=function(e){null!=this.element&&(this.element.innerHTML="",null!=this.dataContext?r.prototype.applyTemplate.call(this,e):e())},e.prototype.onApplyTemplate=function(){r.prototype.onApplyTemplate.call(this),this.applyBindings()},e.prototype.applyBindings=function(){0!=this.isTemplateApplied&&this.onApplyBindings()},e.prototype.onApplyBindings=function(){},e}(i.TemplatedControl),i.ViewBase=t}(Orange||(Orange={})),function(l){!function(i){var n=function(){function e(e){this.element=e,this.control=null,this.isInitialized=!1,this._onInitializedListeners=new Array}return e.prototype.addOnInitializedListener=function(e){this._onInitializedListeners.push(e)},e.prototype.getOnOnitializedListners=function(){return this._onInitializedListeners},e.prototype.removeOnInitializedListener=function(e){var t=this._onInitializedListeners.indexOf(e);-1<t&&this._onInitializedListeners.splice(t,1)},e}();i.GetOrInitializeOrangeElement=function(e){var t=e;return null==t.orange&&(t.orange=new n(e)),t.orange};var e=function(){function s(e){var o=this;this._observer=null,this._element=null,this.onMutation=function(e,t){e.forEach(o.handleMutation)},this.handleMutation=function(e){if("childList"===e.type){for(var t=e.removedNodes,n=0;n<t.length;n++){1===(i=t[n]).nodeType&&s.disposeDescendants(i)}var r=e.addedNodes;for(n=0;n<r.length;n++){var i;1===(i=r[n]).nodeType&&s.createControlsInElement(i,o._container)}}},this._container=e}return Object.defineProperty(s.prototype,"containter",{get:function(){return this._container},enumerable:!0,configurable:!0}),s.disposeDescendants=function(e){if(null==s.getControlAttribute(e)){if(void 0!==e.children)for(var t=0;t<e.children.length;t++)this.disposeDescendants(e.children[t])}else{var n=i.GetOrInitializeOrangeElement(e);null!=n.control&&n.control.dispose()}},s.disposeControl=function(e){if(null!=e){var t=e.element;null!=t&&(t.orange=null);for(var n=e.disposables,r=n.length-1;0<=r;r--)n[r].dispose();if(void 0!==t.children)for(var i=t.children,o=0;o<i.length;o++)s.disposeDescendants(i[o])}},s.prototype.manage=function(e){null!=this._observer&&this.dispose(),this._element=e,this._observer=new MutationObserver(this.onMutation),this._observer.observe(e,s._mutationObserverConfig),s.createControlsInElement(this._element,this._container)},s.getChildren=function(e){var t=new Array;if(null!=typeof e.children)for(var n=0;n<e.children.length;n++)t.push(e.children[n]);return t},s.getControlAttribute=function(e){for(var t=null,n=0;(null==t||""==t)&&n<s._controlAttributeNames.length;)t=e.getAttribute(s._controlAttributeNames[n++]);return null==t||""==t?null:{attributeType:s._controlAttributeNames[n-1],value:t}},s.createControlsInElement=function(e,t){if(null!=s.getControlAttribute(e))s.createControlFromElement(e,t);else for(var n=e.querySelectorAll("["+this._controlAttributeNames.join("], [")+"]"),r=0;r<n.length;++r)s.createControlFromElement(n[r],t)},s.prototype.dispose=function(){this._observer.disconnect(),this._observer=null},s.createControlFromElement=function(t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,s.createControlInternal(t,n)]})})},s.createControlFromType=function(n,r){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return(t=document.createElement("div")).setAttribute(s._controlAttributeNames[0],n),[2,s.createControlInternal(t,r)]})})},s.createControlInternal=function(n,r){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return null==(t=i.GetOrInitializeOrangeElement(n)).promise&&(t.promise=s.createControlInternalImpl(n,r,t)),[4,t.promise];case 1:return[2,e.sent()]}})})},s.createControlInternalImpl=function(i,o,a){return __awaiter(this,void 0,void 0,function(){var t,n,r;return __generator(this,function(e){switch(e.label){case 0:return t=s.getControlAttribute(i),a.control?[2,a.control]:[4,o.resolve(t.value)];case 1:return n=e.sent(),(a.control=n).id=l.Uuid.generate(),i.setAttribute("data-control-id",n.id.value),n.element=i,r=function(){s.getChildren(i).forEach(function(e){return s.createControlsInElement(e,o)}),n.onControlCreated&&n.onControlCreated(),a.isInitialized=!0,a.getOnOnitializedListners().forEach(function(e){return e()})},null==n.applyTemplate?r():n.applyTemplate(r),[2,n]}})})},s.dependencies=function(){return[l.Modularity.Container]},s._mutationObserverConfig={childList:!0,attributes:!1,characterData:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1},s._controlAttributeNames=["data-control","data-view"],s}();i.ControlManager=e}(l.Controls||(l.Controls={}))}(Orange||(Orange={})),function(e){var t,n,r;t=e.Routing||(e.Routing={}),n=function(){function e(e,t){"string"==typeof e&&(e=e.toLowerCase()),this.path=e,this.handler=t}return e.prototype.tryMatch=function(e){var t=this.path;return"*"===t?{}:t instanceof RegExp&&t.test(e)?t.exec(e):t===e?{}:null},e}(),r=function(){function e(){var i=this;this.paths=[],this.listeners=[],this.onpopstate=function(e){i.handleRoute(location.pathname)},this.onclick=function(e){var t=e.target||e.srcElement,n=function(e){return null==e?null:"A"==e.tagName?e:n(e.parentElement)},r=n(t);null==r||"A"!==r.tagName||""!==r.target||r.hostname&&r.hostname!==location.hostname||i.navigate(r.pathname,null)&&e.preventDefault()}}return e.prototype.route=function(e,t){this.paths.push(new n(e,t))},e.prototype.listen=function(e,t){this.listeners.push(new n(e,t))},e.prototype.unroute=function(t){this.paths=this.paths.filter(function(e){return e.path.toString()!==t.toString()})},e.prototype.default=function(e){this.route("*",e)},e.prototype.run=function(){window.addEventListener("popstate",this.onpopstate),window.addEventListener("click",this.onclick),this.handleRoute(location.pathname)},e.prototype.navigate=function(e,t){void 0===t&&(t=null);var n=this.cleanPath(e);return n===this.cleanPath(location.pathname)||!!this.handleRoute(n)&&(history.pushState(t,null,n),!0)},e.prototype.dispose=function(){window.removeEventListener("popstate",this.onpopstate),window.removeEventListener("click",this.onclick)},e.prototype.cleanPath=function(e){return"/"===(e=e.toLowerCase()).substr(-1)&&(e=e.substr(0,e.length-1)),e},e.prototype.handleRoute=function(e){for(var t=0,n=this.listeners;t<n.length;t++){var r=n[t];(a=r.tryMatch(e))&&r.handler(a)}for(var i=0,o=this.paths;i<o.length;i++){var a,s=o[i];if(a=s.tryMatch(e))return s.handler(a),!0}return!1},e}(),t.Router=r}(Orange||(Orange={})),function(e){var t,n;t=e.Controls||(e.Controls={}),n=function(n){function e(e,t){return n.call(this,e,t)||this}return __extends(e,n),e.prototype.onApplyBindings=function(){n.prototype.onApplyBindings.call(this),null!=this.dataContext&&window.ko.applyBindingsToDescendants(this.dataContext,this.element)},e}(t.ViewBase),t.KnockoutViewBase=n}(Orange||(Orange={})),function(u){!function(e){var C,t,f=window.ko;f&&(f.bindingHandlers.stopBindings={init:function(){return console.warn("DEPRECATED: The Orange knockout binding 'stopBindings' is deprecated and will be removed in a future release. Use 'o-stop-bindings' instead."),{controlsDescendantBindings:!0}}},f.virtualElements.allowedBindings.stopBindings=!0,f.bindingHandlers["o-stop-bindings"]={init:function(){return{controlsDescendantBindings:!0}}},f.virtualElements.allowedBindings["o-stop-bindings"]=!0),(t=C||(C={}))[t.TwoWay=0]="TwoWay",t[t.OneWay=1]="OneWay";var x=function(){function e(e,t,n,r,i){var o=this;this.vm=e,this.element=t,this.source=n,this.target=r,this.settings=i,this.propDisposable=null,this.init=function(){null==o.vm&&o.error("No context is pressent for the binding to use."),null==o.element.orange&&o.error("Attempting to bind to a control on a non control element."),null==o.element.orange.control&&o.error("Attempting to bind to a control that has not yet been fully initialized.");var t=o.element.orange.control;if(0==o.isValidTarget(t,o.target)&&0==o.settings.allowDynamic&&o.warn("The target property "+o.target+" could not be found."),"string"!=typeof o.source&&"number"!=typeof o.source&&"boolean"!=typeof o.source){var e=o.source;null==e||null==e.subscribe?t[o.target]=e:f.isObservable(e)&&(t[o.target]=e()),e&&null!=e.subscribe&&(o.propDisposable=e.subscribe(function(e){return t[o.target]=e})),o.settings.mode==C.TwoWay&&(e&&null==e.subscribe?o.warn("Two way bingins are only possible with sources of type Rx.IObservable or knockout observables."):t.addPropertyChangedListener(o.onPropertyChanged))}else t[o.target]=o.source},this.onPropertyChanged=function(e,t){if(e==o.target){var n=o.source;n.onNext?n.onNext(t):f.isObservable(n)||f.isComputed(n)?n(t):o.vm[o.source]=t}};var a=u.Controls.GetOrInitializeOrangeElement(t);a.isInitialized?this.init():a.addOnInitializedListener(this.init)}return e.prototype.getErrorMessage=function(){var e=this.element.getAttribute("data-bind").match(/(o-binding\s*:\s*\[(.|\s)*?\])|(o-binding\s*:\s*\{(.|\s)*?\})/)[0].replace(/\s+/g," ").trim();return{target:this.target,source:this.source,binding:e,element:this.element}},e.prototype.error=function(e){throw console.error(e,this.getErrorMessage()),e+" Se console for mor information."},e.prototype.warn=function(e){console.warn(e,this.getErrorMessage())},e.prototype.isValidTarget=function(e,t){return null!=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),t)||void 0!==e[this.target]},e.prototype.dispose=function(){null!=this.propDisposable&&null!=this.propDisposable.dispose&&this.propDisposable.dispose(),null!=this.element.orange&&(this.element.orange.removeOnInitializedListener(this.init),null!=this.element.orange.control&&this.element.orange.control.removePropertyChangedListener(this.onPropertyChanged))},e}();f&&(f.bindingHandlers["o-binding"]={init:function(e,t,n,r,i){for(var o=new Array,a=t(),s=Array.isArray(a)?a:[a],l=["mode","allow-dynamic"],u=0,c=s;u<c.length;u++){var d=c[u],p=Object.getOwnPropertyNames(d),h=p.filter(function(e){return-1<l.indexOf(e)}),f=p.filter(function(e){return h.indexOf(e)<0});if(f.length<1)throw"No binding property could be found.";var g={mode:C.OneWay,allowDynamic:!1};if(-1<h.indexOf("mode")){var v=d.mode;if("two-way"===v)g.mode=C.TwoWay;else if("one-way"!==v)throw"Binding mode has to be 'one-way' or 'two-way' (was '"+v+"')."}if(-1<h.indexOf("allow-dynamic")){var y=d["allow-dynamic"];if(!0===y)g.allowDynamic=!0;else if(!1!==y)throw"'allow-dynamic' has to be true or false (was '"+y+", typeof(...): "+typeof y+"')."}for(var m=0,b=f;m<b.length;m++){var w=b[m],_=d[w],O=w;o.push(new x(i.$data,e,_,O,g))}}}},f.bindingHandlers.bindings={init:function(e,t,n,r,i){console.warn("DEPRECATED: The Orange knockout binding 'bindings' is deprecated and will be removed in a future release. Use 'o-binding' instead. Binding data: ",n());var o=new Array,a=t();0==Array.isArray(a)&&(a=[a]);for(var s=a.length-1;0<=s;s--){var l=a[s],u=Object.getOwnPropertyNames(l);if(2<u.length)throw"Faulty binding, should be {vmProp:ctrlProp [, mode: m]}, were m can be 'oneWay' or 'twoWay'.";var c={mode:C.OneWay,allowDynamic:!1};if(2==u.length){var d=Object.getOwnPropertyDescriptor(l,"mode").value;if("oneWay"!=d&&"twoWay"!=d)throw"Binding mode has to be 'oneWay' or 'twoWay'.";"twoWay"===d&&C.TwoWay}var p=u.filter(function(e){return"mode"!=e})[0],h=Object.getOwnPropertyDescriptor(l,p).value;o.push(new x(i.$data,e,p,h,c))}f.utils.domNodeDisposal.addDisposeCallback(e,function(){for(var e=o.length-1;0<=e;e--)o[e].dispose()})}},f.bindingHandlers.orangeView={init:function(e,t,n,r,i){console.warn("DEPRECATED: The Orange knockout binding 'orangeView' is deprecated and might be removed in a future version of orange ");var o=t(),a=document.createAttribute("data-view");a.value=o;var s=u.Controls.GetOrInitializeOrangeElement(e);e.setAttributeNode(a);var l=function(){null==s.control.dataContext&&(s.control.dataContext=i.$data)};1==s.isInitialized?l():(s.addOnInitializedListener(l),f.utils.domNodeDisposal.addDisposeCallback(e,function(){return s.removeOnInitializedListener(l)}))}},f.bindingHandlers["orange-vm"]={init:function(e,t,n,r,i){return console.warn("DEPRECATED: The Orange knockout binding 'orange-vm' is deprecated and will be removed in a future version of orange. Use 'o-view-model' instead."),{controlsDescendantBindings:!0}},update:function(e,t,n,r,i){var o=u.Controls.GetOrInitializeOrangeElement(e),a=f.unwrap(t()),s=function(){return o.control.dataContext=a};1==o.isInitialized?s():(o.addOnInitializedListener(s),f.utils.domNodeDisposal.addDisposeCallback(e,function(){o.removeOnInitializedListener(s)}))}},f.bindingHandlers["o-view-model"]={init:function(e,t,n,r,i){return{controlsDescendantBindings:!0}},update:function(e,t,n,r,i){var o=u.Controls.GetOrInitializeOrangeElement(e),a=f.unwrap(t()),s=function(){return o.control.dataContext=a};1==o.isInitialized?s():(o.addOnInitializedListener(s),f.utils.domNodeDisposal.addDisposeCallback(e,function(){o.removeOnInitializedListener(s)}))}})}(u.Bindings||(u.Bindings={}))}(Orange||(Orange={}));