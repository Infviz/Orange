var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}l((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,o=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){l.label=n[1];break}if(6===n[0]&&l.label<a[1]){l.label=a[1],a=n;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(n);break}a[2]&&l.ops.pop(),l.trys.pop();continue}n=t.call(e,l)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};void 0===window.WeakMap&&function(){var e=Object.defineProperty,t=Date.now()%1e9,n=function(){this.name="__st"+(1e9*Math.random()>>>0)+t+++"__"};n.prototype={set:function(t,n){var r=t[this.name];r&&r[0]===t?r[1]=n:e(t,this.name,{value:[t,n],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},delete:function(e){var t=e[this.name];if(!t)return!1;var n=t[0]===e;return t[0]=t[1]=void 0,n},has:function(e){var t=e[this.name];return!!t&&t[0]===e}},window.WeakMap=n}(),function(e){function t(e){w.push(e),b||(b=!0,v(r))}function n(e){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(e)||e}function r(){b=!1;var e=w;w=[],e.sort(function(e,t){return e.uid_-t.uid_});var t=!1;e.forEach(function(e){var n=e.takeRecords();i(e),n.length&&(e.callback_(n,e),t=!0)}),t&&r()}function i(e){e.nodes_.forEach(function(t){var n=g.get(t);n&&n.forEach(function(t){t.observer===e&&t.removeTransientObservers()})})}function o(e,t){for(var n=e;n;n=n.parentNode){var r=g.get(n);if(r)for(var i=0;i<r.length;i++){var o=r[i],a=o.options;if(n===e||a.subtree){var s=t(a);s&&o.enqueue(s)}}}}function a(e){this.callback_=e,this.nodes_=[],this.records_=[],this.uid_=++_}function s(e,t){this.type=e,this.target=t,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function l(e){var t=new s(e.type,e.target);return t.addedNodes=e.addedNodes.slice(),t.removedNodes=e.removedNodes.slice(),t.previousSibling=e.previousSibling,t.nextSibling=e.nextSibling,t.attributeName=e.attributeName,t.attributeNamespace=e.attributeNamespace,t.oldValue=e.oldValue,t}function u(e,t){return O=new s(e,t)}function c(e){return C||(C=l(O),C.oldValue=e,C)}function d(){O=C=void 0}function p(e){return e===C||e===O}function h(e,t){return e===t?e:C&&p(e)?C:null}function f(e,t,n){this.observer=e,this.target=t,this.options=n,this.transientObservedNodes=[]}var g=new window.WeakMap,v=window.msSetImmediate;if(!v){var y=[],m=String(Math.random());window.addEventListener("message",function(e){if(e.data===m){var t=y;y=[],t.forEach(function(e){e()})}}),v=function(e){y.push(e),window.postMessage(m,"*")}}var b=!1,w=[],_=0;a.prototype={observe:function(e,t){if(e=n(e),!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var r=g.get(e);r||g.set(e,r=[]);for(var i,o=0;o<r.length;o++)if(r[o].observer===this){(i=r[o]).removeListeners(),i.options=t;break}i||(i=new f(this,e,t),r.push(i),this.nodes_.push(e)),i.addListeners()},disconnect:function(){this.nodes_.forEach(function(e){for(var t=g.get(e),n=0;n<t.length;n++){var r=t[n];if(r.observer===this){r.removeListeners(),t.splice(n,1);break}}},this),this.records_=[]},takeRecords:function(){var e=this.records_;return this.records_=[],e}};var O,C;f.prototype={enqueue:function(e){var n=this.observer.records_,r=n.length;if(n.length>0){var i=h(n[r-1],e);if(i)return void(n[r-1]=i)}else t(this.observer);n[r]=e},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(e){var t=this.options;t.attributes&&e.addEventListener("DOMAttrModified",this,!0),t.characterData&&e.addEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.addEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(e){var t=this.options;t.attributes&&e.removeEventListener("DOMAttrModified",this,!0),t.characterData&&e.removeEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.removeEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(e){if(e!==this.target){this.addListeners_(e),this.transientObservedNodes.push(e);var t=g.get(e);t||g.set(e,t=[]),t.push(this)}},removeTransientObservers:function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(e){this.removeListeners_(e);for(var t=g.get(e),n=0;n<t.length;n++)if(t[n]===this){t.splice(n,1);break}},this)},handleEvent:function(e){switch(e.stopImmediatePropagation(),e.type){case"DOMAttrModified":var t=e.attrName,n=e.relatedNode.namespaceURI,r=e.target;(i=new u("attributes",r)).attributeName=t,i.attributeNamespace=n;a=e.attrChange===MutationEvent.ADDITION?null:e.prevValue;o(r,function(e){if(e.attributes&&(!e.attributeFilter||!e.attributeFilter.length||-1!==e.attributeFilter.indexOf(t)||-1!==e.attributeFilter.indexOf(n)))return e.attributeOldValue?c(a):i});break;case"DOMCharacterDataModified":var i=u("characterData",r=e.target),a=e.prevValue;o(r,function(e){if(e.characterData)return e.characterDataOldValue?c(a):i});break;case"DOMNodeRemoved":this.addTransientObserver(e.target);case"DOMNodeInserted":var s,l,r=e.relatedNode,p=e.target;"DOMNodeInserted"===e.type?(s=[p],l=[]):(s=[],l=[p]);var h=p.previousSibling,f=p.nextSibling;(i=u("childList",r)).addedNodes=s,i.removedNodes=l,i.previousSibling=h,i.nextSibling=f,o(r,function(e){if(e.childList)return i})}d()}},e.JsMutationObserver=a,e.MutationObserver||(e.MutationObserver=a)}(this);var Orange;!function(e){var t=function(){function e(t){if(null==t)this._value=e.generateV4Uuid();else{if(!e.isUuid(t))throw"The argument passed to Orange.Uuid() is not a valid Uuid.";this._value=t}}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.generateV4Uuid=function(){var t=e.getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})},e.generate=function(){return new e},e.isUuid=function(e){return new RegExp("[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89ab][0-9a-fA-F]{3}-[0-9a-fA-F]{12}").test(e)},e.prototype.sameValueAs=function(e){return this._value.toLowerCase()===e._value.toLowerCase()},e.prototype.toString=function(){return this._value},e}();t._counter=0,t._tStart=null==Date.now?Date.now():(new Date).getTime(),t.getTime=null==window.performance&&null==window.performance.now?function(){return Math.round(performance.now()+t._tStart)}:null==Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},e.Uuid=t}(Orange||(Orange={}));var Orange;!function(e){!function(e){function t(e){if(null==window.Reflect)throw"An attempt to use Orange.Modularity.inject decorator was made without an available Reflect implementation.";e.dependencies=function(){return window.Reflect.getMetadata("design:paramtypes",e)||[]}}e.inject=t;var n=function(e){function t(t,n){var r=e.call(this)||this;return r.innerError=n,r.message=t,r.name="ResolveError",r}return __extends(t,e),t}(Error);e.ResolveError=n;var r=function(){function e(){this.typeMap=[],this.instances=[],this.registerInstance(e,this)}return Object.defineProperty(e,"defaultContainer",{get:function(){return e._defaultContainer},enumerable:!0,configurable:!0}),e.prototype.registerInstance=function(e,t){this.instances.push({key:e,value:t})},e.prototype.registerType=function(e,t){this.typeMap.push({key:e,value:t})},e.prototype.tryResolve=function(t,n){return void 0===n&&(n=!1),__awaiter(this,void 0,void 0,function(){var r,i,o,a;return __generator(this,function(s){switch(s.label){case 0:if("string"!=typeof t)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,e.getConstructorFromString(t)];case 2:return null==(r=s.sent())?[2,{instance:null,success:!1}]:(t=r,[3,4]);case 3:return i=s.sent(),[2,{instance:null,success:!1}];case 4:return null!=(o=this.lookup(this.instances,t))?[2,{instance:o,success:!0}]:(a=this.lookup(this.typeMap,t)||t,0==e.isValidConstructor(a)?[2,{instance:null,success:!1}]:0==this.checkArity(a)?[2,{instance:null,success:!1}]:[4,this.createInstance(a)]);case 5:return o=s.sent(),!0===n&&this.registerInstance(t,o),[2,{instance:o,success:!0}]}})})},e.prototype.resolve=function(t,r){return void 0===r&&(r=!1),__awaiter(this,void 0,void 0,function(){var i,o,a,s,l;return __generator(this,function(u){switch(u.label){case 0:if(i=t,"string"!=typeof t)return[3,5];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,e.getConstructorFromString(t)];case 2:return o=u.sent(),i=o,[3,4];case 3:throw a=u.sent(),new n("Failed to resolve type '"+t+"', see innerError for details",a);case 4:if(null==i)throw new n('No constructor identified by "'+t+'" could be found');u.label=5;case 5:if(null!=(s=this.lookup(this.instances,i)))return[2,s];if(l=this.lookup(this.typeMap,i)||i,0==e.isValidConstructor(l))throw new n('Orange.Modularity.Container failed to resolve type "'+t+'"');if(0==this.checkArity(l))throw new n('Orange.Modularity.Container failed to resolve type "'+t+'"');return[4,this.createInstance(l)];case 6:return s=u.sent(),!0===r&&this.registerInstance(i,s),[2,s]}})})},e.prototype.resolveWithOverride=function(t,n){var r=new e;return r.typeMap=this.typeMap,r.instances=n.concat(this.instances),r.resolve(t,!1)},e.getConstructorFromString=function(t){return __awaiter(this,void 0,void 0,function(){var n,r,i,o,a,s,l,u;return __generator(this,function(c){switch(c.label){case 0:for(n=t.split("."),r=window,i=0,o=n;i<o.length&&(a=o[i],null!=r[a]);i++)r=r[a];if(e.isValidConstructor(r))return[2,r];if(r=null,null!=window.require&&(r=window.require(t)),null!=r)return[3,4];if(null==window.SystemJS)return[3,4];s=window.SystemJS,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,s.import(t)];case 2:return l=c.sent(),r=l,[3,4];case 3:return u=c.sent(),[2,null];case 4:return null==r?[2,null]:e.isValidConstructor(r)?[2,r]:null!=r.default&&e.isValidConstructor(r.default)?[2,r.default]:[2,null]}})})},e.prototype.lookup=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i.key===t)return i.value}},e.prototype.createInstance=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,r,i,o,a,s,l,u;return __generator(this,function(c){switch(c.label){case 0:return 0!=(n=e.dependencies?e.dependencies().length:0)?[3,1]:(t=new e,[3,6]);case 1:r=[],i=e.dependencies(),o=0,a=i,c.label=2;case 2:return o<a.length?(s=a[o],u=(l=r).push,[4,this.resolve(s)]):[3,5];case 3:u.apply(l,[c.sent()]),c.label=4;case 4:return o++,[3,2];case 5:t=this.applyConstructor(e,r),c.label=6;case 6:return[2,t]}})})},e.prototype.checkArity=function(e){return(e.dependencies?e.dependencies().length:0)===(e.length||e.arity||0)},e.isValidConstructor=function(e){return null!=e&&"function"==typeof e},e.prototype.applyConstructor=function(e,t){return new(Function.bind.apply(e,[null].concat(t)))},e}();r._defaultContainer=new r,e.Container=r}(e.Modularity||(e.Modularity={}))}(Orange||(Orange={}));var Orange;!function(Orange){var Modularity;!function(Modularity){var RegionManager=function(){function RegionManager(e){this.container=e}return RegionManager.prototype.disposeRegions=function(e){var t=e.getAttribute("data-view");if(null==t||""==t){if(void 0!==e.children)for(var n=0;n<e.children.length;n++)this.disposeRegions(e.children[n])}else{var r=e.instance;"function"==typeof r.dispose&&r.dispose()}},RegionManager.prototype.initializeRegions=function(root){return __awaiter(this,void 0,void 0,function(){var attr,i,viewType,view,idAttr;return __generator(this,function(_a){switch(_a.label){case 0:if(null!=(attr=root.getAttribute("data-view"))&&""!=attr)return[3,1];if(void 0!==root.children)for(i=0;i<root.children.length;i++)this.initializeRegions(root.children[i]);return[3,3];case 1:return viewType=eval(attr),[4,this.container.resolve(viewType)];case 2:view=_a.sent(),void 0!==view.element&&(view.element=root),idAttr=root.getAttribute("data-view-id"),null!=idAttr&&""!=attr&&"undefined"!==view.setViewId&&view.setViewId(idAttr),root.instance=view,_a.label=3;case 3:return[2]}})})},RegionManager}();Modularity.RegionManager=RegionManager}(Modularity=Orange.Modularity||(Orange.Modularity={}))}(Orange||(Orange={}));var TemplateLoader=function(){function e(){}return e.staticlyLoaded=function(){e.onload&&e.onload()},e.load=function(t){for(var n=0,r=0;r<t.length;r++)!function(){var i=t[r],o=i.id,a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState){if(200!==a.status&&0!==a.status)throw"Failed to load template.";var r=document.createElement("script"),i=document.createAttribute("type");i.value="text/html";var s=document.createAttribute("id");s.value=o,r.setAttributeNode(i),r.setAttributeNode(s),r.innerHTML=a.responseText,document.body.appendChild(r),++n==t.length&&e.onload&&e.onload()}},a.open("GET",i.path,!0),a.send()}()},e}(),Orange;!function(e){!function(e){var t=function(){function t(){this._element=null,this._id=null,this.disposables=new Array,this._propertyChangedListeners=new Array}return Object.defineProperty(t.prototype,"element",{get:function(){return this._element},set:function(e){if(null!=this._element)throw"The 'element' property can only ever be set once.";this._element=e,this.onElementSet()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(e){if(null!=this._id)throw"The 'id' property can only ever be set once.";this._id=e},enumerable:!0,configurable:!0}),t.prototype.addDisposable=function(e){this.disposables.push(e)},t.prototype.dispose=function(){e.ControlManager.disposeControl(this)},t.prototype.addPropertyChangedListener=function(e){this._propertyChangedListeners.push(e)},t.prototype.removePropertyChangedListener=function(e){var t=this._propertyChangedListeners.indexOf(e);t>-1&&this._propertyChangedListeners.splice(t,1)},t.getPropertyName=function(e){var n=t.propertyRegex.exec(String(e));return n[n.length-1]},t.prototype.raisePropertyChanged=function(e){var n=null;if("string"==typeof e)n=e;else{if("function"!=typeof e)throw"Invalid argument passed to raisePropertyChanged";n=t.getPropertyName(e)}if(void 0===this[n])throw"Attempt to access undefined property '"+n+"' was made.";var r=this[n];this.onPropertyChanged(n,r);for(var i=this._propertyChangedListeners.length-1;i>=0;i--)this._propertyChangedListeners[i](n,r)},t.prototype.onElementSet=function(){},t.prototype.onPropertyChanged=function(e,t){},t.prototype.onControlCreated=function(){},t}();t.propertyRegex=/return ([_a-zA-Z0-9]+)(\.([_a-zA-Z0-9]+))*;?/,e.Control=t}(e.Controls||(e.Controls={}))}(Orange||(Orange={}));var Orange;!function(e){!function(e){var t=function(){function e(e){this._template=e}return e.prototype.applyTemplate=function(e,t){e.innerHTML=this._template,t(!0)},e}();e.StringTemplateProvider=t;var n=function(){function e(e){this._templateName=e}return e.prototype.applyTemplate=function(e,t){var n=document.body.querySelector("#"+this._templateName);null!=n?(e.innerHTML=n.innerHTML,t(!0)):t(!1,"No script tag with id='"+this._templateName+"' found")},e}();e.ScriptTemplateProvider=n;var r=function(e){function t(t){var n=e.call(this)||this;return n._templateProvider=null,n._isTemplateApplied=!1,n._templateProvider=t,n}return __extends(t,e),Object.defineProperty(t.prototype,"isTemplateApplied",{get:function(){return this._isTemplateApplied},enumerable:!0,configurable:!0}),t.prototype.onApplyTemplate=function(){},t.prototype.applyTemplate=function(e){var t=this;this._templateProvider.applyTemplate(this.element,function(n,r){if(!n)throw{message:"TemplatedControl.applyTemplate: A template provider failed to apply its template: "+(r||"").toString(),templateProvider:t._templateProvider,element:t.element};t._isTemplateApplied=!0,t.onApplyTemplate(),e()})},t}(e.Control);e.TemplatedControl=r}(e.Controls||(e.Controls={}))}(Orange||(Orange={}));var Orange;!function(e){!function(e){var t=function(t){function n(n,r){var i=t.call(this,new e.ScriptTemplateProvider(n))||this;return i._dataContext=null,i._dataContext=null==r?null:r,i}return __extends(n,t),Object.defineProperty(n.prototype,"dataContext",{get:function(){return this._dataContext},set:function(e){this._dataContext=e,this.applyTemplate(function(){})},enumerable:!0,configurable:!0}),n.prototype.getControl=function(e){var t=this.element.querySelector(e);return null==t||null==t.orange||null==t.orange.control?null:t.orange.control},n.prototype.applyTemplate=function(e){null!=this.element&&(this.element.innerHTML="",null!=this.dataContext?t.prototype.applyTemplate.call(this,e):e())},n.prototype.onApplyTemplate=function(){t.prototype.onApplyTemplate.call(this),this.applyBindings()},n.prototype.applyBindings=function(){0!=this.isTemplateApplied&&this.onApplyBindings()},n.prototype.onApplyBindings=function(){},n}(e.TemplatedControl);e.ViewBase=t}(e.Controls||(e.Controls={}))}(Orange||(Orange={}));var Orange;!function(e){!function(t){var n=function(){function e(e){this.element=e,this.control=null,this.isInitialized=!1,this._onInitializedListeners=new Array}return e.prototype.addOnInitializedListener=function(e){this._onInitializedListeners.push(e)},e.prototype.getOnOnitializedListners=function(){return this._onInitializedListeners},e.prototype.removeOnInitializedListener=function(e){var t=this._onInitializedListeners.indexOf(e);t>-1&&this._onInitializedListeners.splice(t,1)},e}();t.GetOrInitializeOrangeElement=function(e){var t=e;return null==t.orange&&(t.orange=new n(e)),t.orange};var r=function(){function n(e){var t=this;this._observer=null,this._element=null,this.onMutation=function(e,n){e.forEach(t.handleMutation)},this.handleMutation=function(e){if("childList"===e.type){for(var r=e.removedNodes,i=0;i<r.length;i++)1===(a=r[i]).nodeType&&n.disposeDescendants(a);for(var o=e.addedNodes,i=0;i<o.length;i++){var a=o[i];1===a.nodeType&&n.createControlsInElement(a,t._container)}}},this._container=e}return Object.defineProperty(n.prototype,"containter",{get:function(){return this._container},enumerable:!0,configurable:!0}),n.disposeDescendants=function(e){if(null==n.getControlAttribute(e)){if(void 0!==e.children)for(var r=0;r<e.children.length;r++)this.disposeDescendants(e.children[r])}else{var i=t.GetOrInitializeOrangeElement(e);null!=i.control&&i.control.dispose()}},n.disposeControl=function(e){if(null!=e){var t=e.element;null!=t&&(t.orange=null);for(var r=e.disposables,i=r.length-1;i>=0;i--)r[i].dispose();if(void 0!==t.children)for(var o=t.children,a=0;a<o.length;a++)n.disposeDescendants(o[a])}},n.prototype.manage=function(e){null!=this._observer&&this.dispose(),this._element=e,this._observer=new MutationObserver(this.onMutation),this._observer.observe(e,n._mutationObserverConfig),n.createControlsInElement(this._element,this._container)},n.getChildren=function(e){var t=new Array;if(null!=typeof e.children)for(var n=0;n<e.children.length;n++)t.push(e.children[n]);return t},n.getControlAttribute=function(e){for(var t=null,r=0;(null==t||""==t)&&r<n._controlAttributeNames.length;)t=e.getAttribute(n._controlAttributeNames[r++]);return null==t||""==t?null:{attributeType:n._controlAttributeNames[r-1],value:t}},n.createControlsInElement=function(e,t){if(null!=n.getControlAttribute(e))n.createControlFromElement(e,t);else for(var r=e.querySelectorAll("["+this._controlAttributeNames.join("], [")+"]"),i=0;i<r.length;++i)n.createControlFromElement(r[i],t)},n.prototype.dispose=function(){this._observer.disconnect(),this._observer=null},n.createControlFromElement=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,n.createControlInternal(e,t)]})})},n.createControlFromType=function(e,t){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(i){return(r=document.createElement("div")).setAttribute(n._controlAttributeNames[0],e),[2,n.createControlInternal(r,t)]})})},n.createControlInternal=function(e,r){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(o){switch(o.label){case 0:return null==(i=t.GetOrInitializeOrangeElement(e)).promise&&(i.promise=n.createControlInternalImpl(e,r,i)),[4,i.promise];case 1:return[2,o.sent()]}})})},n.createControlInternalImpl=function(t,r,i){return __awaiter(this,void 0,void 0,function(){var o,a,s;return __generator(this,function(l){switch(l.label){case 0:return o=n.getControlAttribute(t),i.control?[2,i.control]:[4,r.resolve(o.value)];case 1:return a=l.sent(),i.control=a,a.id=e.Uuid.generate(),t.setAttribute("data-control-id",a.id.value),a.element=t,s=function(){n.getChildren(t).forEach(function(e){return n.createControlsInElement(e,r)}),a.onControlCreated&&a.onControlCreated(),i.isInitialized=!0,i.getOnOnitializedListners().forEach(function(e){return e()})},null==a.applyTemplate?s():a.applyTemplate(s),[2,a]}})})},n}();r.dependencies=function(){return[e.Modularity.Container]},r._mutationObserverConfig={childList:!0,attributes:!1,characterData:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1},r._controlAttributeNames=["data-control","data-view"],t.ControlManager=r}(e.Controls||(e.Controls={}))}(Orange||(Orange={}));var Orange;!function(e){!function(e){var t=function(){function e(e,t){"string"==typeof e&&(e=e.toLowerCase()),this.path=e,this.handler=t}return e.prototype.tryMatch=function(e){var t=this.path;return"*"===t?{}:t instanceof RegExp&&t.test(e)?t.exec(e):t===e?{}:null},e}(),n=function(){function e(){var e=this;this.paths=[],this.listeners=[],this.onpopstate=function(t){e.handleRoute(location.pathname)},this.onclick=function(t){var n=t.target||t.srcElement,r=function(e){return null==e?null:"A"==e.tagName?e:r(e.parentElement)},i=r(n);null==i||"A"!==i.tagName||""!==i.target||i.hostname&&i.hostname!==location.hostname||e.navigate(i.pathname,null)&&t.preventDefault()}}return e.prototype.route=function(e,n){this.paths.push(new t(e,n))},e.prototype.listen=function(e,n){this.listeners.push(new t(e,n))},e.prototype.unroute=function(e){this.paths=this.paths.filter(function(t){return t.path.toString()!==e.toString()})},e.prototype.default=function(e){this.route("*",e)},e.prototype.run=function(){window.addEventListener("popstate",this.onpopstate),window.addEventListener("click",this.onclick),this.handleRoute(location.pathname)},e.prototype.navigate=function(e,t){void 0===t&&(t=null);var n=this.cleanPath(e);return n===this.cleanPath(location.pathname)||!!this.handleRoute(n)&&(history.pushState(t,null,n),!0)},e.prototype.dispose=function(){window.removeEventListener("popstate",this.onpopstate),window.removeEventListener("click",this.onclick)},e.prototype.cleanPath=function(e){return"/"===(e=e.toLowerCase()).substr(-1)&&(e=e.substr(0,e.length-1)),e},e.prototype.handleRoute=function(e){for(var t=0,n=this.listeners;t<n.length;t++){var r=n[t];(s=r.tryMatch(e))&&r.handler(s)}for(var i=0,o=this.paths;i<o.length;i++){var a=o[i],s=a.tryMatch(e);if(s)return a.handler(s),!0}return!1},e}();e.Router=n}(e.Routing||(e.Routing={}))}(Orange||(Orange={}));var Orange;!function(e){!function(e){var t=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.onApplyBindings=function(){e.prototype.onApplyBindings.call(this),null!=this.dataContext&&window.ko.applyBindingsToDescendants(this.dataContext,this.element)},t}(e.ViewBase);e.KnockoutViewBase=t}(e.Controls||(e.Controls={}))}(Orange||(Orange={}));var Orange;!function(e){!function(t){var n=window.ko;n&&(n.bindingHandlers.stopBindings={init:function(){return console.warn("DEPRECATED: The Orange knockout binding 'stopBindings' is deprecated and will be removed in a future release. Use 'o-stop-bindings' instead."),{controlsDescendantBindings:!0}}},n.virtualElements.allowedBindings.stopBindings=!0,n.bindingHandlers["o-stop-bindings"]={init:function(){return{controlsDescendantBindings:!0}}},n.virtualElements.allowedBindings["o-stop-bindings"]=!0);var r;!function(e){e[e.TwoWay=0]="TwoWay",e[e.OneWay=1]="OneWay"}(r||(r={}));var i=function(){function t(t,i,o,a,s){var l=this;this.vm=t,this.element=i,this.source=o,this.target=a,this.settings=s,this.propDisposable=null,this.init=function(){null==l.vm&&l.error("No context is pressent for the binding to use."),null==l.element.orange&&l.error("Attempting to bind to a control on a non control element."),null==l.element.orange.control&&l.error("Attempting to bind to a control that has not yet been fully initialized.");var e=l.element.orange.control;if(0==l.isValidTarget(e,l.target)&&0==l.settings.allowDynamic&&l.warn("The target property "+l.target+" could not be found."),"string"!=typeof l.source&&"number"!=typeof l.source&&"boolean"!=typeof l.source){var t=l.source;null==t||null==t.subscribe?e[l.target]=t:n.isObservable(t)&&(e[l.target]=t()),t&&null!=t.subscribe&&(l.propDisposable=t.subscribe(function(t){return e[l.target]=t})),l.settings.mode==r.TwoWay&&(t&&null==t.subscribe?l.warn("Two way bingins are only possible with sources of type Rx.IObservable or knockout observables."):e.addPropertyChangedListener(l.onPropertyChanged))}else e[l.target]=l.source},this.onPropertyChanged=function(e,t){if(e==l.target){var r=l.source;r.onNext?r.onNext(t):n.isObservable(r)||n.isComputed(r)?r(t):l.vm[l.source]=t}};var u=e.Controls.GetOrInitializeOrangeElement(i);u.isInitialized?this.init():u.addOnInitializedListener(this.init)}return t.prototype.getErrorMessage=function(){var e=this.element.getAttribute("data-bind").match(/(o-binding\s*:\s*\[(.|\s)*?\])|(o-binding\s*:\s*\{(.|\s)*?\})/)[0].replace(/\s+/g," ").trim();return{target:this.target,source:this.source,binding:e,element:this.element}},t.prototype.error=function(e){throw console.error(e,this.getErrorMessage()),e+" Se console for mor information."},t.prototype.warn=function(e){console.warn(e,this.getErrorMessage())},t.prototype.isValidTarget=function(e,t){return null!=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),t)||void 0!==e[this.target]},t.prototype.dispose=function(){null!=this.propDisposable&&null!=this.propDisposable.dispose&&this.propDisposable.dispose(),null!=this.element.orange&&(this.element.orange.removeOnInitializedListener(this.init),null!=this.element.orange.control&&this.element.orange.control.removePropertyChangedListener(this.onPropertyChanged))},t}();n&&(n.bindingHandlers["o-binding"]={init:function(e,t,n,o,a){for(var s=new Array,l=t(),u=["mode","allow-dynamic"],c=0,d=Array.isArray(l)?l:[l];c<d.length;c++){var p=d[c],h=Object.getOwnPropertyNames(p),f=h.filter(function(e){return u.indexOf(e)>-1}),g=h.filter(function(e){return f.indexOf(e)<0});if(g.length<1)throw"No binding property could be found.";var v={mode:r.OneWay,allowDynamic:!1};if(f.indexOf("mode")>-1){var y=p.mode;if("two-way"===y)v.mode=r.TwoWay;else if("one-way"!==y)throw"Binding mode has to be 'one-way' or 'two-way' (was '"+y+"')."}if(f.indexOf("allow-dynamic")>-1){var m=p["allow-dynamic"];if(!0===m)v.allowDynamic=!0;else if(!1!==m)throw"'allow-dynamic' has to be true or false (was '"+m+", typeof(...): "+typeof m+"')."}for(var b=0,w=g;b<w.length;b++){var _=w[b],O=p[_],C=_;s.push(new i(a.$data,e,O,C,v))}}}},n.bindingHandlers.bindings={init:function(e,t,o,a,s){console.warn("DEPRECATED: The Orange knockout binding 'bindings' is deprecated and will be removed in a future release. Use 'o-binding' instead. Binding data: ",o());var l=new Array,u=t();0==Array.isArray(u)&&(u=[u]);for(var c=u.length-1;c>=0;c--){var d=u[c],p=Object.getOwnPropertyNames(d);if(p.length>2)throw"Faulty binding, should be {vmProp:ctrlProp [, mode: m]}, were m can be 'oneWay' or 'twoWay'.";var h={mode:r.OneWay,allowDynamic:!1};if(2==p.length){var f=Object.getOwnPropertyDescriptor(d,"mode").value;if("oneWay"!=f&&"twoWay"!=f)throw"Binding mode has to be 'oneWay' or 'twoWay'.";"twoWay"===f&&r.TwoWay}var g=p.filter(function(e){return"mode"!=e})[0],v=Object.getOwnPropertyDescriptor(d,g).value;l.push(new i(s.$data,e,g,v,h))}n.utils.domNodeDisposal.addDisposeCallback(e,function(){for(var e=l.length-1;e>=0;e--)l[e].dispose()})}},n.bindingHandlers.orangeView={init:function(t,r,i,o,a){console.warn("DEPRECATED: The Orange knockout binding 'orangeView' is deprecated and might be removed in a future version of orange ");var s=r(),l=document.createAttribute("data-view");l.value=s;var u=e.Controls.GetOrInitializeOrangeElement(t);t.setAttributeNode(l);var c=function(){null==u.control.dataContext&&(u.control.dataContext=a.$data)};1==u.isInitialized?c():(u.addOnInitializedListener(c),n.utils.domNodeDisposal.addDisposeCallback(t,function(){return u.removeOnInitializedListener(c)}))}},n.bindingHandlers["orange-vm"]={init:function(e,t,n,r,i){return console.warn("DEPRECATED: The Orange knockout binding 'orange-vm' is deprecated and will be removed in a future version of orange. Use 'o-view-model' instead."),{controlsDescendantBindings:!0}},update:function(t,r,i,o,a){var s=e.Controls.GetOrInitializeOrangeElement(t),l=n.unwrap(r()),u=function(){return s.control.dataContext=l};1==s.isInitialized?u():(s.addOnInitializedListener(u),n.utils.domNodeDisposal.addDisposeCallback(t,function(){s.removeOnInitializedListener(u)}))}},n.bindingHandlers["o-view-model"]={init:function(e,t,n,r,i){return{controlsDescendantBindings:!0}},update:function(t,r,i,o,a){var s=e.Controls.GetOrInitializeOrangeElement(t),l=n.unwrap(r()),u=function(){return s.control.dataContext=l};1==s.isInitialized?u():(s.addOnInitializedListener(u),n.utils.domNodeDisposal.addDisposeCallback(t,function(){s.removeOnInitializedListener(u)}))}})}(e.Bindings||(e.Bindings={}))}(Orange||(Orange={}));